============================= test session starts ==============================
platform darwin -- Python 3.13.11, pytest-9.0.2, pluggy-1.6.0 -- /Users/jwalinshah/projects/jarvis-ai-assistant/.venv/bin/python
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /Users/jwalinshah/projects/jarvis-ai-assistant
configfile: pyproject.toml
plugins: anyio-4.12.1, syrupy-5.1.0, langsmith-0.6.9, timeout-2.4.0, asyncio-1.3.0, hypothesis-6.151.5, Faker-37.12.0, cov-7.0.0
timeout: 30.0s
timeout method: thread
timeout func_only: False
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 24 items

tests/unit/test_category_classifier.py::TestCategoryResult::test_repr PASSED [  4%]
tests/unit/test_category_classifier.py::TestCategoryResult::test_fields PASSED [  8%]
tests/unit/test_category_classifier.py::TestFastPath::test_reaction_tapback PASSED [ 12%]
tests/unit/test_category_classifier.py::TestFastPath::test_acknowledgment_ok PASSED [ 16%]
tests/unit/test_category_classifier.py::TestFastPath::test_acknowledgment_got_it PASSED [ 20%]
tests/unit/test_category_classifier.py::TestFastPath::test_acknowledgment_sounds_good PASSED [ 25%]
tests/unit/test_category_classifier.py::TestFastPath::test_normal_message_no_fast_path PASSED [ 29%]
tests/unit/test_category_classifier.py::TestFallbackNoModel::test_default_statement PASSED [ 33%]
tests/unit/test_category_classifier.py::TestFallbackNoModel::test_default_with_context PASSED [ 37%]
tests/unit/test_category_classifier.py::TestAPIContract::test_classify_category_returns_category_result PASSED [ 41%]
tests/unit/test_category_classifier.py::TestAPIContract::test_result_has_valid_category PASSED [ 45%]
tests/unit/test_category_classifier.py::TestAPIContract::test_confidence_in_range PASSED [ 50%]
tests/unit/test_category_classifier.py::TestAPIContract::test_method_is_string PASSED [ 54%]
tests/unit/test_category_classifier.py::TestAPIContract::test_context_param_optional PASSED [ 58%]
tests/unit/test_category_classifier.py::TestAPIContract::test_mobilization_param_optional PASSED [ 62%]
tests/unit/test_category_classifier.py::TestAPIContract::test_all_params PASSED [ 66%]
tests/unit/test_category_classifier.py::TestCategoryClassifier::test_classifier_init PASSED [ 70%]
tests/unit/test_category_classifier.py::TestCategoryClassifier::test_load_svm_returns_false_when_no_model PASSED [ 75%]
tests/unit/test_category_classifier.py::TestCategoryClassifier::test_fast_path_takes_priority PASSED [ 79%]
tests/unit/test_category_classifier.py::TestFeatureExtraction::test_extract_hand_crafted_features PASSED [ 83%]
tests/unit/test_category_classifier.py::TestFeatureExtraction::test_extract_spacy_features PASSED [ 87%]
tests/unit/test_category_classifier.py::TestFeatureExtraction::test_spacy_imperative_detection PASSED [ 91%]
tests/unit/test_category_classifier.py::TestFeatureExtraction::test_spacy_you_modal_detection PASSED [ 95%]
tests/unit/test_category_classifier.py::TestFeatureExtraction::test_spacy_agreement_detection PASSED [100%]/Users/jwalinshah/projects/jarvis-ai-assistant/.venv/lib/python3.13/site-packages/coverage/inorout.py:495: CoverageWarning: Module benchmarks was never imported. (module-not-imported); see https://coverage.readthedocs.io/en/7.13.2/messages.html#warning-module-not-imported
  self.warn(f"Module {pkg} was never imported.", slug="module-not-imported")
/Users/jwalinshah/projects/jarvis-ai-assistant/.venv/lib/python3.13/site-packages/coverage/report_core.py:107: CoverageWarning: Couldn't parse Python file '/Users/jwalinshah/projects/jarvis-ai-assistant/jarvis/memory_layer.py' (couldnt-parse); see https://coverage.readthedocs.io/en/7.13.2/messages.html#warning-couldnt-parse
  coverage._warn(msg, slug="couldnt-parse")


=============================== warnings summary ===============================
<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.13.11-final-0 _______________

Name                                            Stmts   Miss  Cover   Missing
-----------------------------------------------------------------------------
api/__init__.py                                     2      2     0%   13-15
api/dependencies.py                                13     13     0%   7-54
api/errors.py                                      59     59     0%   21-372
api/main.py                                        78     78     0%   15-390
api/ratelimit.py                                   90     90     0%   15-258
api/routers/__init__.py                            31     31     0%   3-34
api/routers/analytics.py                          302    302     0%   11-1022
api/routers/attachments.py                         97     97     0%   12-490
api/routers/batch.py                               83     83     0%   7-438
api/routers/calendar.py                            75     75     0%   7-373
api/routers/config.py                               4      4     0%   9-13
api/routers/contacts.py                           194    194     0%   7-563
api/routers/conversations.py                       80     80     0%   11-714
api/routers/core.py                                 5      5     0%   8-15
api/routers/custom_templates.py                   145    145     0%   10-605
api/routers/data.py                                 4      4     0%   9-13
api/routers/debug.py                              163    163     0%   7-324
api/routers/drafts.py                             201    201     0%   14-879
api/routers/embeddings.py                          94     94     0%   13-378
api/routers/experiments.py                        151    151     0%   16-611
api/routers/export.py                              91     91     0%   6-315
api/routers/feedback.py                           118    118     0%   9-767
api/routers/generation.py                           4      4     0%   8-14
api/routers/graph.py                              148    148     0%   7-560
api/routers/health.py                             105    105     0%   10-312
api/routers/metrics.py                            110    110     0%   6-322
api/routers/pdf_export.py                          80     80     0%   6-255
api/routers/priority.py                           131    131     0%   12-766
api/routers/relationships.py                       85     85     0%   12-583
api/routers/scheduler.py                          198    198     0%   7-690
api/routers/search.py                              69     69     0%   10-430
api/routers/settings.py                           164    164     0%   10-722
api/routers/stats.py                              144    144     0%   10-596
api/routers/suggestions.py                         67     67     0%   11-411
api/routers/tags.py                               261    261     0%   13-897
api/routers/tasks.py                              150    150     0%   7-524
api/routers/template_analytics.py                  79     79     0%   7-233
api/routers/templates.py                            4      4     0%   8-14
api/routers/threads.py                             66     66     0%   10-511
api/routers/topics.py                             141    141     0%   9-598
api/routers/websocket.py                          280    280     0%   10-741
api/schemas/__init__.py                            14     14     0%   10-162
api/schemas/analytics.py                          102    102     0%   7-822
api/schemas/attachments.py                         53     53     0%   6-355
api/schemas/calendar.py                            61     61     0%   6-448
api/schemas/drafts.py                              48     48     0%   6-420
api/schemas/export.py                             120    120     0%   6-520
api/schemas/graph.py                               75     75     0%   6-138
api/schemas/messages.py                            46     46     0%   6-316
api/schemas/settings.py                            53     53     0%   6-434
api/schemas/stats.py                               34     34     0%   6-231
api/schemas/system.py                              30     30     0%   6-247
api/schemas/tags.py                               147    147     0%   6-527
api/schemas/templates.py                           84     84     0%   6-616
api/schemas/threads.py                             30     30     0%   6-259
contracts/__init__.py                               9      0   100%
contracts/calendar.py                              86     31    64%   44-49, 88-97, 133-138, 161, 177, 189, 197, 217, 235, 247, 275, 291
contracts/hallucination.py                         46     18    61%   34-36, 67-78, 94, 105, 120
contracts/health.py                                65     16    75%   14, 92-97, 109, 122, 130, 138, 153, 161, 173, 188, 200
contracts/imessage.py                             106     43    59%   43-54, 75-80, 104-111, 150-155, 182-190, 198, 204, 210, 233, 239
contracts/latency.py                               52     18    65%   12, 47-55, 88-93, 113, 128
contracts/memory.py                                63     26    59%   14, 43-51, 82-93, 112, 124, 132, 143, 155, 163
contracts/models.py                                71     39    45%   43-60, 89-104, 119, 127, 135, 143, 151
core/__init__.py                                    0      0   100%
core/health/__init__.py                             5      5     0%   7-30
core/health/circuit.py                            130    130     0%   11-301
core/health/degradation.py                        133    133     0%   9-429
core/health/permissions.py                        125    125     0%   9-340
core/health/schema.py                              81     81     0%   9-275
core/memory/__init__.py                             3      3     0%   7-15
core/memory/controller.py                          92     92     0%   7-288
core/memory/monitor.py                             30     30     0%   6-92
integrations/__init__.py                            0      0   100%
integrations/calendar/__init__.py                   4      4     0%   35-51
integrations/calendar/detector.py                 159    159     0%   7-501
integrations/calendar/reader.py                   142    142     0%   6-428
integrations/calendar/writer.py                    75     75     0%   6-248
integrations/imessage/__init__.py                   5      5     0%   20-31
integrations/imessage/avatar.py                    91     91     0%   7-224
integrations/imessage/parser.py                   205    205     0%   15-543
integrations/imessage/queries.py                   54     54     0%   10-456
integrations/imessage/reader.py                   819    819     0%   6-1921
integrations/imessage/sender.py                    81     81     0%   21-226
jarvis/__init__.py                                  1      0   100%
jarvis/__main__.py                                  1      1     0%   10
jarvis/_cli_main.py                               498    498     0%   24-909
jarvis/analytics/__init__.py                        6      6     0%   10-40
jarvis/analytics/aggregator.py                    231    231     0%   7-562
jarvis/analytics/engine.py                        244    244     0%   7-557
jarvis/analytics/reports.py                        97     97     0%   7-576
jarvis/analytics/trends.py                        190    190     0%   10-507
jarvis/api_models.py                               91     91     0%   6-191
jarvis/classifiers/__init__.py                      6      0   100%
jarvis/classifiers/category_classifier.py         146     29    80%   34, 238, 247-253, 283-328
jarvis/classifiers/factory.py                      23      2    91%   72, 96
jarvis/classifiers/lazy.py                         64     47    27%   93-97, 110-135, 150-174, 184-186, 196, 206
jarvis/classifiers/mixins.py                       73     49    33%   28, 56-60, 99-123, 138-151, 172-203, 212
jarvis/classifiers/patterns.py                     64     46    28%   27, 66-77, 89-95, 111-117, 121, 155-167, 180-188, 200-207, 215
jarvis/classifiers/relationship_classifier.py     306    306     0%   23-912
jarvis/classifiers/response_mobilization.py       163    100    39%   341-345, 350-439, 453-603, 619, 624, 629, 642-649, 654, 719-720
jarvis/cli/__init__.py                              5      5     0%   14-38
jarvis/cli/commands/__init__.py                     0      0   100%
jarvis/cli/deps.py                                 21     21     0%   16-59
jarvis/cli/parser.py                                2      2     0%   6-8
jarvis/cli/utils.py                               101    101     0%   6-208
jarvis/config.py                                  318    108    66%   547-558, 564-579, 585-596, 601-604, 612-638, 644-662, 668-671, 677-680, 686-692, 697-710, 745-747, 770-771, 776-781, 794-795, 798-800, 813-828, 850-851, 871-874, 883, 889, 894, 903
jarvis/context.py                                 139    139     0%   6-344
jarvis/db/__init__.py                              28     28     0%   17-105
jarvis/db/artifacts.py                             49     49     0%   3-270
jarvis/db/clusters.py                              63     63     0%   3-142
jarvis/db/contacts.py                              93     93     0%   3-234
jarvis/db/core.py                                 202    202     0%   3-484
jarvis/db/embeddings.py                            86     86     0%   3-273
jarvis/db/index_versions.py                        28     28     0%   3-82
jarvis/db/models.py                               188    188     0%   3-315
jarvis/db/pairs.py                                118    118     0%   3-367
jarvis/db/schema.py                                 5      5     0%   4-244
jarvis/db/search.py                               150    150     0%   3-616
jarvis/db/stats.py                                 47     47     0%   3-138
jarvis/dspy_client.py                              56     56     0%   20-134
jarvis/embedding_adapter.py                       221    127    43%   41, 95-96, 150, 154, 170-172, 183-184, 194, 199-201, 229-308, 312-315, 343, 348, 356-358, 361, 364-371, 374-378, 382, 386, 395-447, 495-500, 509-513
jarvis/errors.py                                  259    113    56%   132-142, 146, 166-173, 212-217, 252-257, 310-317, 357-360, 395-404, 439-443, 483-490, 527-534, 568, 613-616, 659-664, 734-743, 778-783, 816-822, 857-862, 922-927, 965, 982, 999, 1019-1025, 1042, 1058, 1074, 1092, 1114, 1129
jarvis/eval/__init__.py                             0      0   100%
jarvis/eval/adaptive_thresholds.py                193    193     0%   22-581
jarvis/eval/evaluation.py                         424    424     0%   18-1136
jarvis/eval/experiments.py                        344    344     0%   36-850
jarvis/eval/feedback.py                           284    284     0%   41-909
jarvis/export.py                                  113    113     0%   9-408
jarvis/fallbacks.py                                42     42     0%   7-181
jarvis/generation.py                               69     69     0%   7-186
jarvis/graph/__init__.py                            5      5     0%   7-32
jarvis/graph/builder.py                           238    238     0%   7-633
jarvis/graph/clustering.py                        167    167     0%   7-393
jarvis/graph/export.py                            108    108     0%   7-548
jarvis/graph/layout.py                            254    254     0%   7-497
jarvis/metrics.py                                 402    288    28%   71, 87-88, 92-100, 111-130, 135, 151-157, 161-166, 170-174, 178-184, 188-207, 215-217, 221-223, 240-243, 251-252, 260-272, 284-285, 296-299, 308-310, 322-332, 340-341, 349-353, 362-365, 380-382, 391-394, 409, 420-425, 441-466, 477-482, 495-500, 507-509, 512-513, 521-522, 539-543, 553-557, 567-571, 577-583, 592-599, 619-638, 653-660, 675-690, 698-702, 712-713, 722-725, 733-736, 744-748, 759-765, 778-779, 787-792, 800-803, 818-827, 835-836, 867-871, 887-892, 903-912, 921-927, 935-939, 947-949, 972-976, 986-990, 1000-1004
jarvis/model_warmer.py                            228    228     0%   29-569
jarvis/nlp/__init__.py                              5      5     0%   10-29
jarvis/nlp/coref_resolver.py                       90     90     0%   26-218
jarvis/nlp/ner_client.py                          136    136     0%   17-327
jarvis/nlp/slang.py                                21     21     0%   14-244
jarvis/nlp/validity_gate.py                       189    189     0%   16-436
jarvis/observability/__init__.py                    0      0   100%
jarvis/observability/insights.py                  293    293     0%   10-802
jarvis/observability/metrics_router.py            233    233     0%   12-558
jarvis/observability/metrics_validation.py         95     95     0%   7-184
jarvis/pdf_generator.py                           193    193     0%   7-569
jarvis/prefetch/__init__.py                       140    140     0%   34-506
jarvis/prefetch/cache.py                          498    498     0%   14-1108
jarvis/prefetch/executor.py                       387    387     0%   16-799
jarvis/prefetch/invalidation.py                   216    216     0%   15-587
jarvis/prefetch/predictor.py                      377    377     0%   17-908
jarvis/priority.py                                298    298     0%   13-748
jarvis/prompts.py                                 513    513     0%   10-2288
jarvis/relationships.py                           469    469     0%   15-1323
jarvis/reply_service.py                           248    248     0%   8-666
jarvis/retry.py                                   100    100     0%   7-260
jarvis/router.py                                  171    171     0%   22-459
jarvis/scheduler/__init__.py                        5      5     0%   22-42
jarvis/scheduler/executor.py                      203    203     0%   16-508
jarvis/scheduler/models.py                        170    170     0%   17-461
jarvis/scheduler/queue.py                         291    291     0%   14-608
jarvis/scheduler/scheduler.py                     178    178     0%   21-534
jarvis/scheduler/timing.py                        193    193     0%   13-473
jarvis/search/__init__.py                           0      0   100%
jarvis/search/embeddings.py                       298    298     0%   42-1140
jarvis/search/ingest.py                            71     71     0%   14-168
jarvis/search/segment_ingest.py                    51     51     0%   15-121
jarvis/search/semantic_search.py                  225    225     0%   17-653
jarvis/search/vec_search.py                       241    241     0%   23-704
jarvis/services/__init__.py                         8      8     0%   7-15
jarvis/services/api.py                             20     20     0%   3-43
jarvis/services/base.py                           183    183     0%   3-380
jarvis/services/context_service.py                 85     85     0%   3-187
jarvis/services/embedding.py                       26     26     0%   8-61
jarvis/services/manager.py                        129    129     0%   7-244
jarvis/services/ner.py                             35     35     0%   3-67
jarvis/services/socket.py                          26     26     0%   3-55
jarvis/setup.py                                   281    281     0%   12-787
jarvis/socket_server.py                           663    663     0%   20-1489
jarvis/system.py                                   68     68     0%   7-187
jarvis/tags/__init__.py                             5      5     0%   18-36
jarvis/tags/auto_tagger.py                        192    192     0%   17-664
jarvis/tags/manager.py                            349    349     0%   21-1148
jarvis/tags/models.py                             243    243     0%   17-559
jarvis/tags/rules.py                              204    204     0%   13-497
jarvis/tasks/__init__.py                            4      4     0%   39-60
jarvis/tasks/models.py                            118    118     0%   15-304
jarvis/tasks/queue.py                             202    202     0%   14-451
jarvis/tasks/worker.py                            254    254     0%   16-528
jarvis/text_normalizer.py                         321    237    26%   18, 305-320, 328-342, 382-452, 457-461, 476-484, 501-521, 541-543, 548-564, 569-574, 586-628, 632-643, 653-658, 662-664, 669-699, 704-709, 715, 725, 734-736, 741-747, 755-764, 769-779, 791-804, 824, 847-850, 876-895
jarvis/threading.py                               336    336     0%   13-846
jarvis/topics/__init__.py                           2      2     0%   3-15
jarvis/topics/topic_segmenter.py                  387    387     0%   35-1141
jarvis/utils/__init__.py                            2      2     0%   3-11
jarvis/utils/memory.py                            194    194     0%   15-416
jarvis/watcher.py                                 293    293     0%   9-563
models/__init__.py                                 38     24    37%   115-134, 144-146, 161-166
models/bert_embedder.py                           264    206    22%   64-68, 71-82, 89-96, 99-124, 131-138, 142-151, 158-159, 164-166, 173-188, 193-204, 214-265, 275-278, 299-301, 305-388, 392-403, 407-408, 426-491, 496, 500, 523, 535-538
models/cross_encoder.py                           180    180     0%   20-379
models/embeddings.py                               21      5    76%   73-78
models/generator.py                               223    186    17%   22, 34-38, 68-72, 80-88, 105-112, 141-206, 210-217, 221-231, 235, 243-246, 250, 254, 276-379, 415, 438-487, 506-522, 538-568, 579-596, 614-648, 653, 657, 661, 665, 681
models/loader.py                                  422    341    19%   65-70, 105-126, 131-133, 138, 155-157, 195-207, 211, 215, 230-259, 270-275, 289-298, 309-320, 332-393, 405-424, 429, 442-482, 486-490, 505-533, 542-553, 558, 565-569, 605-771, 812-921, 940-953, 962, 988-992, 1004-1007
models/prompt_builder.py                           33     22    33%   39-59, 70-71, 82-88, 99
models/registry.py                                134    101    25%   64, 206, 218-221, 237-263, 272-273, 295-326, 336-341, 349, 373-514
models/reranker.py                                 54     54     0%   13-126
models/templates.py                               412    305    26%   43, 62, 83-87, 96-106, 110-115, 119-122, 127-129, 133-136, 164-172, 181-183, 192-196, 268, 286, 303, 331-334, 338-350, 360-371, 375-376, 380-381, 385-386, 390-391, 395-396, 400-401, 405-409, 420-428, 440-454, 465-472, 476-479, 487-499, 519-527, 544-573, 582, 592-596, 602-603, 608, 1894, 1920-1925, 1936-1975, 1990-2008, 2030-2094, 2109-2127, 2152-2225, 2229, 2233, 2237-2241, 2245
-----------------------------------------------------------------------------
TOTAL                                           28258  26679     6%
======================== 24 passed, 2 warnings in 2.88s ========================
<sys>:0: DeprecationWarning: builtin type swigvarlink has no __module__ attribute
