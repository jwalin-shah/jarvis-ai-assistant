uv run pytest tests/ --tb=long -v --junit-xml=test_results.xml --timeout=30 --timeout-method=thread 2>&1 | tee test_results.txt
Uninstalled 1 package in 642ms
Installed 1 package in 231ms
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0 -- /Users/jwalinshah/coding/jarvis-ai-assistant/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jwalinshah/coding/jarvis-ai-assistant
configfile: pyproject.toml
plugins: anyio-4.12.1, timeout-2.4.0, asyncio-1.3.0, cov-7.0.0
timeout: 30.0s
timeout method: thread
timeout func_only: False
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 2485 items

tests/integration/test_api.py::TestCreateApp::test_create_app_returns_fastapi PASSED [  0%]
tests/integration/test_api.py::TestHealthEndpoint::test_health_returns_200 PASSED [  0%]
tests/integration/test_api.py::TestHealthEndpoint::test_health_returns_valid_structure PASSED [  0%]
tests/integration/test_api.py::TestHealthEndpoint::test_health_memory_has_required_fields PASSED [  0%]
tests/integration/test_api.py::TestHealthEndpoint::test_health_model_has_required_fields PASSED [  0%]
tests/integration/test_api.py::TestHealthEndpoint::test_health_status_is_valid PASSED [  0%]
tests/integration/test_api.py::TestHealthEndpoint::test_health_version_matches PASSED [  0%]
tests/integration/test_api.py::TestChatEndpoint::test_chat_with_valid_message PASSED [  0%]
tests/integration/test_api.py::TestChatEndpoint::test_chat_with_fallback_response PASSED [  0%]
tests/integration/test_api.py::TestChatEndpoint::test_chat_rejects_empty_message PASSED [  0%]
tests/integration/test_api.py::TestChatEndpoint::test_chat_validates_max_tokens PASSED [  0%]
tests/integration/test_api.py::TestChatEndpoint::test_chat_validates_temperature PASSED [  0%]
tests/integration/test_api.py::TestChatEndpoint::test_chat_accepts_context_documents PASSED [  0%]
tests/integration/test_api.py::TestChatEndpoint::test_chat_handles_model_import_error PASSED [  0%]
tests/integration/test_api.py::TestChatEndpoint::test_chat_handles_generation_error PASSED [  0%]
tests/integration/test_api.py::TestChatStreamingEndpoint::test_chat_streaming_returns_sse PASSED [  0%]
tests/integration/test_api.py::TestChatStreamingEndpoint::test_chat_streaming_contains_events PASSED [  0%]
tests/integration/test_api.py::TestSearchEndpoint::test_search_with_valid_query PASSED [  0%]
tests/integration/test_api.py::TestSearchEndpoint::test_search_requires_query PASSED [  0%]
tests/integration/test_api.py::TestSearchEndpoint::test_search_validates_limit PASSED [  0%]
tests/integration/test_api.py::TestSearchEndpoint::test_search_with_all_filters PASSED [  0%]
tests/integration/test_api.py::TestSearchEndpoint::test_search_returns_messages PASSED [  0%]
tests/integration/test_api.py::TestSearchEndpoint::test_search_handles_permission_error PASSED [  0%]
tests/integration/test_api.py::TestConversationsEndpoint::test_conversations_returns_list PASSED [  0%]
tests/integration/test_api.py::TestConversationsEndpoint::test_conversations_with_filters PASSED [  1%]
tests/integration/test_api.py::TestConversationsEndpoint::test_conversations_returns_data PASSED [  1%]
tests/integration/test_api.py::TestConversationsEndpoint::test_conversations_handles_permission_error PASSED [  1%]
tests/integration/test_api.py::TestMessagesEndpoint::test_messages_returns_list PASSED [  1%]
tests/integration/test_api.py::TestMessagesEndpoint::test_messages_with_filters PASSED [  1%]
tests/integration/test_api.py::TestMessagesEndpoint::test_messages_returns_data PASSED [  1%]
tests/integration/test_api.py::TestMessagesEndpoint::test_messages_handles_permission_error PASSED [  1%]
tests/integration/test_api.py::TestMessagesEndpoint::test_messages_handles_special_chat_id PASSED [  1%]
tests/integration/test_api.py::TestAPIModels::test_chat_request_validation PASSED [  1%]
tests/integration/test_api.py::TestAPIModels::test_chat_response_model PASSED [  1%]
tests/integration/test_api.py::TestAPIModels::test_message_response_with_attachments PASSED [  1%]
tests/integration/test_api.py::TestAPIModels::test_health_response_model PASSED [  1%]
tests/integration/test_api.py::TestServeCommand::test_serve_command_exists PASSED [  1%]
tests/integration/test_api.py::TestServeCommand::test_serve_default_options PASSED [  1%]
tests/integration/test_api.py::TestServeCommand::test_serve_custom_options PASSED [  1%]
tests/integration/test_api.py::TestServeCommand::test_serve_starts_uvicorn PASSED [  1%]
tests/integration/test_api.py::TestServeCommand::test_serve_handles_error PASSED [  1%]
tests/integration/test_api.py::TestCORSMiddleware::test_cors_allows_tauri_origin PASSED [  1%]
tests/integration/test_api.py::TestCORSMiddleware::test_cors_headers_in_response PASSED [  1%]
tests/integration/test_api.py::TestHelperFunctions::test_check_imessage_access_returns_bool PASSED [  1%]
tests/integration/test_api.py::TestHelperFunctions::test_template_only_response_returns_string PASSED [  1%]
tests/integration/test_api.py::TestHelperFunctions::test_fallback_response_returns_string PASSED [  1%]
tests/integration/test_api.py::TestHelperFunctions::test_imessage_degraded_returns_empty_list PASSED [  1%]
tests/integration/test_api.py::TestHelperFunctions::test_imessage_fallback_returns_empty_list PASSED [  1%]
tests/integration/test_api.py::TestMessageConversion::test_message_to_response PASSED [  1%]
tests/integration/test_api.py::TestMessageConversion::test_conversation_to_response PASSED [  2%]
tests/integration/test_api.py::TestMessageConversion::test_attachment_to_response PASSED [  2%]
tests/integration/test_api.py::TestMessageConversion::test_reaction_to_response PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_app_is_fastapi_instance PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_all_expected_routers_mounted PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_health_endpoint_registered PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_root_endpoint_registered PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_openapi_schema_available PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_docs_endpoint_available PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_redoc_endpoint_available PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_exception_handlers_registered PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_cors_middleware_configured PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_limiter_in_app_state PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_metrics_middleware_adds_response_time_header PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_openapi_has_custom_metadata PASSED [  2%]
tests/integration/test_api_integration.py::TestFastAPIAppStartup::test_openapi_has_tag_descriptions PASSED [  2%]
tests/integration/test_api_integration.py::TestRateLimiterUnderLoad::test_rate_limit_enforced_after_limit_exceeded PASSED [  2%]
tests/integration/test_api_integration.py::TestRateLimiterUnderLoad::test_rate_limit_handler_returns_proper_response PASSED [  2%]
tests/integration/test_api_integration.py::TestRateLimiterUnderLoad::test_concurrent_requests_handled_properly PASSED [  2%]
tests/integration/test_api_integration.py::TestRateLimiterUnderLoad::test_get_remote_address_extracts_ip PASSED [  2%]
tests/integration/test_api_integration.py::TestRateLimiterUnderLoad::test_get_remote_address_localhost_includes_hash PASSED [  2%]
tests/integration/test_api_integration.py::TestRateLimiterUnderLoad::test_different_user_agents_have_different_keys PASSED [  2%]
tests/integration/test_api_integration.py::TestRateLimiterUnderLoad::test_rate_limit_constants_defined PASSED [  2%]
tests/integration/test_api_integration.py::TestRateLimiterUnderLoad::test_with_timeout_decorator PASSED [  2%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_migration_from_v1_to_current PASSED [  2%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_migration_from_v2_to_current PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_migration_from_v3_to_current PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_migration_model_path_to_model_id_mapping PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_corrupted_json_returns_defaults PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_empty_json_returns_defaults PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_empty_file_returns_defaults PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_invalid_field_values_returns_defaults PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_invalid_nested_field_values_returns_defaults PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_invalid_theme_literal_returns_defaults PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_missing_fields_get_defaults PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_extra_unknown_fields_ignored PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_migration_persists_to_disk PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_migrate_config_function_directly PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_migrate_config_preserves_existing_sections PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_nonexistent_config_file_returns_defaults PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_unreadable_config_file_returns_defaults PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_save_and_load_roundtrip PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_config_version_constant_matches_schema PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_rate_limit_config_in_jarvis_config PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_task_queue_config_in_jarvis_config PASSED [  3%]
tests/integration/test_api_integration.py::TestConfigMigrationEdgeCases::test_digest_config_in_jarvis_config PASSED [  3%]
tests/integration/test_api_integration.py::TestAppLifespanEvents::test_app_starts_without_errors PASSED [  3%]
tests/integration/test_api_integration.py::TestAppLifespanEvents::test_multiple_requests_after_startup PASSED [  3%]
tests/integration/test_api_integration.py::TestAppLifespanEvents::test_error_handling_preserves_app_state PASSED [  3%]
tests/integration/test_api_integration.py::TestAppLifespanEvents::test_concurrent_startup_requests PASSED [  3%]
tests/integration/test_api_integration.py::TestAppLifespanEvents::test_app_handles_different_endpoints_concurrently PASSED [  4%]
tests/integration/test_api_integration.py::TestAppLifespanEvents::test_testclient_context_manager_handles_startup_shutdown PASSED [  4%]
tests/integration/test_api_integration.py::TestAppLifespanEvents::test_app_state_isolated_between_requests PASSED [  4%]
tests/integration/test_api_integration.py::TestRateLimiterWindowReset::test_rate_limit_reset_simulation PASSED [  4%]
tests/integration/test_api_integration.py::TestRateLimiterWindowReset::test_rate_limit_key_generation_consistency PASSED [  4%]
tests/integration/test_api_integration.py::TestRateLimiterWindowReset::test_rate_limit_different_ips_get_different_limits PASSED [  4%]
tests/integration/test_api_integration.py::TestConfigThreadSafety::test_concurrent_config_access PASSED [  4%]
tests/integration/test_api_integration.py::TestConfigThreadSafety::test_concurrent_config_reset_and_access PASSED [  4%]
tests/integration/test_api_integration.py::TestErrorHandlerIntegration::test_jarvis_error_returns_proper_response PASSED [  4%]
tests/integration/test_api_integration.py::TestErrorHandlerIntegration::test_validation_error_returns_400 FAILED [  4%]
tests/integration/test_api_integration.py::TestErrorHandlerIntegration::test_404_for_nonexistent_endpoint PASSED [  4%]
tests/integration/test_api_integration.py::TestErrorHandlerIntegration::test_405_for_wrong_method PASSED [  4%]
tests/integration/test_api_integration.py::TestMiddlewareIntegration::test_response_time_header_present PASSED [  4%]
tests/integration/test_api_integration.py::TestMiddlewareIntegration::test_response_time_is_valid_float PASSED [  4%]
tests/integration/test_api_integration.py::TestMiddlewareIntegration::test_cors_headers_for_allowed_origin PASSED [  4%]
tests/integration/test_api_integration.py::TestMiddlewareIntegration::test_metrics_middleware_records_requests PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_creates_successfully PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_has_verbose_flag PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_has_version_flag PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_chat_command PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_search_messages_command PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_search_messages_with_limit PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_health_command PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_benchmark_command PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_benchmark_with_output PASSED [  4%]
tests/integration/test_cli.py::TestCreateParser::test_parser_benchmark_validates_type PASSED [  5%]
tests/integration/test_cli.py::TestInitializeSystem::test_initialize_returns_success PASSED [  5%]
tests/integration/test_cli.py::TestInitializeSystem::test_initialize_registers_features PASSED [  5%]
tests/integration/test_cli.py::TestInitializeSystem::test_initialize_warns_about_permissions PASSED [  5%]
tests/integration/test_cli.py::TestCmdVersion::test_version_returns_zero PASSED [  5%]
tests/integration/test_cli.py::TestCmdHealth::test_health_returns_zero PASSED [  5%]
tests/integration/test_cli.py::TestMain::test_main_with_no_args_shows_help PASSED [  5%]
tests/integration/test_cli.py::TestMain::test_main_with_version PASSED   [  5%]
tests/integration/test_cli.py::TestMain::test_main_with_health PASSED    [  5%]
tests/integration/test_cli.py::TestSearchMessages::test_search_messages_no_access PASSED [  5%]
tests/integration/test_cli.py::TestSearchMessages::test_parser_search_messages_with_start_date PASSED [  5%]
tests/integration/test_cli.py::TestSearchMessages::test_parser_search_messages_with_end_date PASSED [  5%]