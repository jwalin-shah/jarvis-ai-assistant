#!/bin/bash
# Post-checkout hook: runs after git checkout/switch
# Reminds to sync dependencies if lockfile changed between branches

# $1 = previous HEAD, $2 = new HEAD, $3 = 1 if branch checkout (0 if file checkout)
prev_head=$1
new_head=$2
is_branch_checkout=$3

# Only run for branch checkouts, not file checkouts
if [ "$is_branch_checkout" != "1" ]; then
    exit 0
fi

changed_files=$(git diff --name-only "$prev_head" "$new_head" 2>/dev/null || echo "")

if echo "$changed_files" | grep -q "uv.lock\|pyproject.toml"; then
    echo ""
    echo "================================================"
    echo "  Dependencies changed. Run 'make install' to sync."
    echo "================================================"
    echo ""
fi
